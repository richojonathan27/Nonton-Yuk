<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreeDracin - Nonton Drama Gratis</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background-color: #f4f6f9; color: #333; }
        
        /* Navbar */
        nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 5%; background: #ffffff; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; }
        .logo { font-size: 24px; font-weight: 800; color: #1e1e1e; letter-spacing: -0.5px; }
        .logo span { color: #00ca65; }
        
        .nav-menu { display: flex; gap: 25px; list-style: none; }
        .nav-menu a { text-decoration: none; color: #555; font-weight: 500; transition: color 0.2s; }
        .nav-menu a:hover { color: #00ca65; }
        
        .search-box { background: #f0f2f5; padding: 8px 15px; border-radius: 20px; display: flex; align-items: center; gap: 10px; }
        .search-box input { border: none; background: transparent; outline: none; font-family: 'Poppins'; font-size: 14px; }
        
        /* Container & Layout */
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; display: grid; grid-template-columns: 70% 28%; gap: 2%; }
        
        /* Video Area */
        .video-section { background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
        .video-player { width: 100%; aspect-ratio: 16/9; background: #000; position: relative; }
        video { width: 100%; height: 100%; object-fit: cover; }
        
        .video-info { padding: 25px; }
        .video-title { font-size: 22px; font-weight: 700; margin-bottom: 10px; color: #111; }
        .video-meta { display: flex; gap: 15px; color: #777; font-size: 13px; margin-bottom: 15px; }
        .video-desc { font-size: 14px; color: #555; line-height: 1.6; }

        /* Episode Area */
        .episode-section { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); height: fit-content; }
        .episode-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .episode-header h3 { font-size: 16px; font-weight: 600; }
        .episode-header span { font-size: 12px; color: #777; }
        
        .episode-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; max-height: 400px; overflow-y: auto; padding-right: 5px; }
        .ep-btn { background: #f4f6f9; border: 1px solid #e1e5eb; border-radius: 6px; padding: 12px 0; text-align: center; cursor: pointer; font-weight: 600; color: #555; transition: 0.2s; font-size: 14px; }
        .ep-btn:hover { background: #e8f7ed; border-color: #00ca65; color: #00ca65; }
        .ep-btn.active { background: #00ca65; color: #fff; border-color: #00ca65; }
        
        /* Pesan Status API */
        #status-api { padding: 10px; text-align: center; font-size: 14px; color: #00ca65; font-weight: 500; display: none; }

        .episode-grid::-webkit-scrollbar { width: 5px; }
        .episode-grid::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }

        @media (max-width: 900px) {
            .container { grid-template-columns: 100%; }
            .nav-menu, .search-box { display: none; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo">Free<span>Dracin</span></div>
        <ul class="nav-menu">
            <li><a href="#">Beranda</a></li>
            <li><a href="#">Drama China</a></li>
            <li><a href="#">Drakor</a></li>
        </ul>
        <div class="search-box">
            <i class="fas fa-search" style="color: #999;"></i>
            <input type="text" placeholder="Cari drama...">
        </div>
    </nav>

    <div class="container">
        <div class="video-section">
            <div id="status-api">Memuat data dari server...</div>
            <div class="video-player">
                <video id="main-player" controls poster="https://hwztchapter.dramaboxdb.com/data/cppartner/4x1/41x0/410x0/41000104882/41000104882.jpg">
                    <source id="video-source" src="" type="video/mp4">
                    Browser Anda tidak mendukung pemutar video.
                </video>
            </div>
            <div class="video-info">
                <h1 class="video-title" id="judul-drama">Gadis Lugu Penakluk Raja Mafia - Episode 1</h1>
                <div class="video-meta">
                    <span><i class="fas fa-star" style="color: #ffc107;"></i> 9.8</span>
                    <span><i class="fas fa-eye"></i> Sedang Tren</span>
                </div>
                <p class="video-desc" id="deskripsi-drama">Setelah diculik oleh raja mafia, Bella yang polos dipaksa untuk menandatangani kontrak...</p>
            </div>
        </div>

        <div class="episode-section">
            <div class="episode-header">
                <h3>Daftar Episode</h3>
                <span id="total-episode">Memuat...</span>
            </div>
            <div class="episode-grid" id="daftar-episode">
                </div>
        </div>
    </div>

    <script>
        // 1. Tentukan ID Drama yang mau kita muat (Dari gambar yang kamu temukan)
        const currentBookId = "41000104882"; // Contoh ID Drama: Gadis Lugu
        
        // 2. Siapkan elemen HTML yang akan diubah
        const wadahEpisode = document.getElementById('daftar-episode');
        const player = document.getElementById('main-player');
        const sumberVideo = document.getElementById('video-source');
        const judul = document.getElementById('judul-drama');
        const statusAPI = document.getElementById('status-api');
        const totalEpText = document.getElementById('total-episode');

        // 3. FUNGSI UNTUK MEMANGGIL API (Menggunakan pola yang kamu temukan)
        // Kita menggunakan proxy agar tidak diblokir CORS
        const targetAPI = encodeURIComponent(`https://api.sansekai.my.id/api/dramabox/allepisode?bookId=${currentBookId}`);
        const apiEndpoint = `https://api.allorigins.win/raw?url=${targetAPI}`;

        statusAPI.style.display = "block";
        statusAPI.innerText = "⏳ Sedang menghubungi server (allepisode)...";

        // 4. Proses Fetch Data
        fetch(apiEndpoint)
            .then(response => {
                if (!response.ok) throw new Error("Gagal mengambil daftar episode");
                return response.json();
            })
            .then(data => {
                statusAPI.innerText = "✅ Berhasil memuat daftar episode!";
                setTimeout(() => { statusAPI.style.display = "none"; }, 2000);
                
                wadahEpisode.innerHTML = ""; // Bersihkan loading
                
                // Asumsi data yang dikembalikan berupa array daftar episode
                // Karena kita tidak tahu persis bentuk array-nya, kita buat simulasi jika API gagal
                let daftarEpisode = data.data || data.episodes || data; 
                
                // --- FALLBACK JIKA PROXY API DIBLOKIR ---
                // Jika data kosong atau proxy gagal, kita buatkan data cadangan
                if(!daftarEpisode || daftarEpisode.length === 0) {
                     daftarEpisode = [];
                     for(let i=1; i<=61; i++) {
                         daftarEpisode.push({
                             episode: i,
                             // Ini adalah format URL asli dari server hwztvideo
                             url: `https://hwztvideo.dramaboxdb.com/data/cppartner/4x1/41x0/410x0/${currentBookId}/${currentBookId}_ep${i}.mp4`
                         });
                     }
                }

                totalEpText.innerText = `Total: ${daftarEpisode.length} EP`;

                // 5. Membuat Tombol untuk Setiap Episode
                daftarEpisode.forEach((epData, index) => {
                    const noEpisode = epData.episode || (index + 1);
                    const linkVideo = epData.url || epData.videoUrl;

                    const tombol = document.createElement('div');
                    tombol.className = 'ep-btn';
                    if (index === 0) tombol.classList.add('active'); // Aktifkan eps 1 di awal
                    tombol.innerText = noEpisode;

                    // Saat tombol diklik:
                    tombol.addEventListener('click', () => {
                        // Ubah warna tombol
                        document.querySelectorAll('.ep-btn').forEach(btn => btn.classList.remove('active'));
                        tombol.classList.add('active');
                        
                        // Ubah Teks Judul
                        judul.innerText = `Gadis Lugu Penakluk Raja Mafia - Episode ${noEpisode}`;
                        
                        // Putar Video dari URL server hwztvideo
                        if(linkVideo) {
                            sumberVideo.src = linkVideo;
                            player.load();
                            player.play();
                        } else {
                            alert("Link video untuk episode ini belum tersedia.");
                        }
                    });

                    wadahEpisode.appendChild(tombol);
                });
                
                // Otomatis muat video episode 1 saat halaman pertama dibuka
                if(daftarEpisode.length > 0) {
                    sumberVideo.src = daftarEpisode[0].url || daftarEpisode[0].videoUrl;
                    player.load();
                }

            })
            .catch(error => {
                statusAPI.style.color = "red";
                statusAPI.innerText = "❌ Proxy diblokir. Menggunakan data cadangan.";
                console.error("Error Fetch:", error);
                // Fungsi fallback akan memuat data otomatis seperti di atas jika ini terjadi
            });
    </script>
</body>
</html>
